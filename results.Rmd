---
title: "Analiza wydajności struktur pamięciowych baz danych"
author: "Mikołaj Mierzejewski, Kamil Osak, Filip Szóstak"
date: "`r Sys.Date()`"
output:
  html_document: 
    toc: yes
    toc_float: yes
    theme: spacelab
    number_sections: yes
    df_print: kable
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set( echo  = FALSE)
library(dplyr)
library(ggplot2)
library(plotly)
```


```{r init, echo=FALSE}
draw_chart <- function(operation) {
  data <- read.csv(paste("out/", operation, ".csv", sep=""), header=FALSE, col.names=c("database", "time", "size"))
  df <- data %>%
    mutate(database=factor(database, labels=c('Dictionary', 'List', 'T-Tree')), time=time/1000, size=size/1000) %>%
    group_by(database, size) %>%
    summarize(time=mean(time), .groups='drop')
  
  return(
    ggplot(df, aes(x=size, y=time, color=database, fill=database, shape=database)) + 
      geom_point() + 
      geom_smooth(formula = y ~ x, method = 'lm') + 
      labs(
        x="Database size [thousands of records]", 
        color="", 
        fillz="", 
        y="Operation time [s]", 
        title=paste("Memory structure effeciency for", operation, "operation.")) + 
      scale_y_continuous(trans='log10') + 
      scale_fill_discrete(name="Memory structure type:") +
      scale_color_discrete(name="Memory structure type:") +
      scale_shape_discrete(name="Memory structure type:")
   )
    
}
```

# Abstract

# Wprowadzenie

## Motywacje i opis problemu

## Wybrane struktury pamięciowe 

## Cel pracy 

# Implementacja struktur pamięciowych

## Lista

### Dodawanie

### Odczyt

### Odczyt sekwencyjny

### Aktualizacja

### Usuwanie

## Słownik

### Dodawanie

### Odczyt

### Odczyt sekwencyjny

### Aktualizacja

### Usuwanie

## T-Drzewo

### Dodawanie

### Odczyt

### Odczyt sekwencyjny

### Aktualizacja

### Usuwanie

# Metodologia badań

W tym rozdziale zostanie opisana obrana metodologia badań uwzględniająca poszczególne operacje, środowisko oraz sposób przeprowadzenia badań.

## Wybrane operacje

Do badań wybrano 6 różnych operacji:

- Dodawanie - do istniejącej bazy danych dodano *n* różnych nowych wartości o kolejnych wartościach indeksu, rozpoczynających się od wartości większej o `1` od największej obecnie istniejących. Pod każdy z kluczy generowano losowo dane osoby (imię, nazwisko, numer PESEL, adres mailowy, numer telefonu, wiek oraz adres).

- Odczyt - do odczytu wybierano każdorazowo losową wartość ze wszystkich wartości indeksu bazy danych.

- Odczyt sekwencyjny - do odczytu wybierano każdorazowo losową wartość początkową przedziału. Na jej podstawie każdorazowo dokonano `100` odczytów sekwencyjnych wartości kluczy. 

- Aktualizacja - do aktualizacji wybierano każdorazowo losową wartość ze wszystkich wartości indeksu bazy danych, a następnie dokonywano ponownego generowania danych osoby.

- Usuwanie - do usuwania wybrano każdorazowo losową wartość, od wartości minimalnej, do maksymalnej z bazy danych. Niektóre odczyty mogły próbować usunąć wartość nieistniejącą.

- Połączenie operacji - operacja składająca się z łańcucha 100 operacji odczytu z całej bazy danych, `100` operacji dodania wartości o nowych indeksach wzorem operacji dodania oraz 100 operacji usunięcia dodanych przed chwilą danych.

## Przeprowadzone badania 

W celu uzyskania miarodajnych wyników, objęto poniższą metodologie badań.

Każda z operacji została wykonana `3000` razy pod rząd, w celu uniknięcia tzw. outlayerów, mierząc czas wykonania zbioru operacji. Pozwoliło to osiągnąć uśrednione czasy dla każdej z operacji. W czas operacji jest również wliczony losowy wybór wartości z przedziału zależnego od wielkości danych.

Sekwencje operacji zostały uruchomione na bazach danych z różną, początkową ilością danych. zaczynając na `10,000` rekordach, kończąc na `100,000` z krokiem `10,000`.

W celu zminimalizowania wpływu usług uruchamianych przez system w tle niezależnie od użytkownika, generując outlayery, cały proces został wykonany `3` razy, pozwalając na uśrednienie wyników badań.

## Opis środowiska

Środowisko do przeprowadzenia badań stanowi komputer wyposażony w:

- Procesor Ryzen 5 3600
- 16 GB pamięci DDR4 o taktowaniu 3200 MHz
- System Windows 11 w wersji `21H2`
- Python w wersji `3.11.1`

W ramach przeprowadzanych badań, nie dokonywano żadnych operacji na wyżej wymienionym systemie.

# Wyniki badań

W tej sekcji zawiera się wizualizacja oraz opis wyników przeprowadzonych badań.

## Dodawanie danych
```{r create}
ggplotly(draw_chart("create"))
```

## Odczyt losowy danych
```{r read}
ggplotly(draw_chart("read"))
```

## Odczyt sekwencyjny danych
```{r read_range}
ggplotly(draw_chart("read_range"))
```

## Aktualizacja danych
```{r update}
ggplotly(draw_chart("update"))
```

## Usuwanie danych
```{r delete}
ggplotly(draw_chart("delete"))
```

# Zakończenie

## Podsumowanie prac i wnioski

# Literatura

